metadata:
  name: "Beddel Protocol Expert (Streaming)"
  version: "1.0.0"
  builtin: true
  description: "Multi-step assistant with streaming response"
  observability:
    enabled: true

workflow:
  # Step 1: Fetch Beddel documentation via GitMCP
  - id: "fetch-docs"
    type: "mcp-tool"
    config:
      url: "https://gitmcp.io/botanarede/beddel"
      tool: "fetch_beddel_documentation"
      arguments: {}
    result: "beddelDocs"

  # Step 2: Search for specific content in documentation
  - id: "search-docs"
    type: "mcp-tool"
    config:
      url: "https://gitmcp.io/botanarede/beddel"
      tool: "search_beddel_documentation"
      arguments:
        query: "$input.query"
    result: "searchResults"

  # Step 3: Stream response using chat primitive
  - id: "respond"
    type: "chat"
    config:
      provider: "google"
      model: "gemini-2.0-flash-exp"
      system: |
        You are an expert assistant specialized in the Beddel Protocol.
        Use the documentation provided to answer questions accurately.
        
        Always respond in Portuguese (Brazilian).
        Be concise but complete. Include code examples when relevant.
        If the documentation doesn't cover the topic, say so clearly.
        
        ## Beddel Documentation Index
        $stepResult.beddelDocs.data
        
        ## Search Results for User Query
        $stepResult.searchResults.data
      messages: "$input.messages"
